<!DOCTYPE html>

<html lang="en">
<head>
	<title>Stargazing Saga: The adventures of a space cadet</title>
	<!-- <script async="" defer="" src="http://s7.addthis.com/js/250/addthis_widget.js#pubid=xa-4e4813104686cad8"></script> -->
	<link rel="stylesheet" type="text/css" href="style.css">
</head>

<body>
	<canvas id="space" ></canvas>

<script>
// requestAnimFrame shim
window.requestAnimFrame = (function()
{
   return  window.requestAnimationFrame       || 
           window.webkitRequestAnimationFrame || 
           window.mozRequestAnimationFrame    || 
           window.oRequestAnimationFrame      || 
           window.msRequestAnimationFrame     || 
           function(callback)
           {
               window.setTimeout(callback);
           };
})();

// get dimensions of window and resize the canvas to fit
var width = document.body.clientWidth,
    height = document.body.clientHeight,
    canvas = document.getElementById("space"),
    mousex = width/2, mousey = height/2;
canvas.width = width;
canvas.height = height;

// get 2d graphics context and set global alpha
var G=canvas.getContext("2d");
G.globalAlpha=0.5;

// constants and storage for objects that represent star positions
var warpZ = 150,	// speed
    units = 500,	// number of stars
    stars = [],
    cycle = 0,
    Z = 0.1  		//brightness of stars

// function to reset a star object
function resetstar(a)
{
   // a.x = (Math.random() * width - (width * 0.5)) * warpZ;
   // a.y = (Math.random() * height - (height * 0.5)) * warpZ;

   a.x = (Math.random() * width - (width * 0.5)) * warpZ;
   a.y = (Math.random() * height - (height * 0.5)) * warpZ;

   a.z = warpZ;

   // previous position
   a.px = 0;
   a.py = 0;
}

// initial star setup
for (var i=0, n; i<units; i++){
	n = {};
	resetstar(n);
	stars.push(n);
}

// star rendering anim function
var rf = function()
{
   // clear background
   G.fillStyle = "#000";
   G.fillRect(0, 0, width, height);
   
   // position to head towards
   var cx = document.body.clientWidth /2,
       cy = document.body.clientHeight /2;
   
   // update all stars
   var sat = Math.floor(Z * 500);       // Z range 0.01 -> 0.5
   if (sat > 100) sat = 100;
   for (var i=0; i<units; i++)
   {
      var n = stars[i],            // the star
          xx = n.x / n.z,          // star position
          yy = n.y / n.z,
          e = (1.0 / n.z + 1) * 2;   // size i.e. z
      
      if (n.px !== 0)
      {
         // hsl colour from a sine wave
         G.strokeStyle = "hsl(" + ((cycle * i) % 360) + "," + sat + "%,80%)";
         G.lineWidth = e;
         G.beginPath();
         G.moveTo(xx + cx, yy + cy);
         G.lineTo(n.px + cx, n.py + cy);
         G.stroke();
      }
      
      // update star position values with new settings
      n.px = xx;
      n.py = yy;
      n.z -= Z;
      
      // reset when star is out of the view field
      if (n.z < Z || n.px > width || n.py > height)
      {
         // reset star
         resetstar(n);
      }
   }
   
   // colour cycle sinewave rotation
   cycle += 0.01;
   
   requestAnimFrame(rf);
};
requestAnimFrame(rf);
</script>

</body></html>

<!--
<html lang="en">
<head>
	<link rel="stylesheet" type="text/css" href="style.css">
	<script src="http://code.jquery.com/jquery-latest.js"></script>
	<link href='http://fonts.googleapis.com/css?family=Paprika' rel='stylesheet' type='text/css'>
	<title>Stargazing Saga: The many adventures of a space cadet</title>
</head>
<body>
	<div class="stars"></div>
	<div class="twinkling"></div>
	<div class="clouds"></div>
</body>
</html>
-->